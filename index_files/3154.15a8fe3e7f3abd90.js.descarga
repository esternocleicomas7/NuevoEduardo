(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3154],{93154:function(o,b,a){"use strict";a.r(b),a.d(b,{AddressForm:function(){return an},"default":function(){return ao}});var c,p=a(85893),q=a(67294),r=a(5434),s=a(23157),t=a(40076),u=a(88385),v=a(35438),w=a(69528),x=a(38855),y=a(301),z=a(88315),A=a(52860),B=a(90257),C=a(50900),D=a(5528),E=a(13344),F=a(16825),G=a(40332),H=a(89431),I=a(55888),J=a(47598),K=a(59450),L=a(13467),M=a(99590),N=a(84339),O=a(3172),P=a(81601);function Q(){var b=(0,F.Z)(),a=(0,O.aM)({query:P.x3,variables:{websiteId:b},partial:!0}),c=a.data,d=a.loading,e=a.error;return{data:c,loading:d,error:e}}var f=a(34051),R=a.n(f),d=a(76661),S=a(50319);function T(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function U(c,d,e,f,g,h,i){try{var a=c[h](i),b=a.value}catch(j){e(j);return}a.done?d(b):Promise.resolve(b).then(f,g)}function g(){var a,b,c=(a=["\n  mutation setPreferencesAddressProviderHook($websiteId: ID, $deliveryType: ID) {\n    setUserPreferences(websiteId: $websiteId, deliveryType: $deliveryType) {\n      _id\n      deliveryType\n    }\n  }\n"],b||(b=a.slice(0)),Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(b)}})));return g=function(){return c},c}var V=(0,d.Ps)(g());function W(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function X(c,d,e,f,g,h,i){try{var a=c[h](i),b=a.value}catch(j){e(j);return}a.done?d(b):Promise.resolve(b).then(f,g)}function h(){var a,b,c=(a=["\n  mutation setUserStoreIdPreferencesAddressProviderHook($websiteId: ID, $storeId: ID) {\n    setUserPreferences(websiteId: $websiteId, storeId: $storeId) {\n      _id\n      storeId\n      store {\n        _id\n        name\n        schedule {\n          itsOpenNow: itsAvailableAt\n        }\n        acceptServeSchedulingOrders\n        schedulingOrdersDays\n        currentPreparationDuration\n        currentExtraDeliveryCost\n        currentDeliveryDuration\n        isOverloaded\n        address {\n          address\n          placeId\n          addressLine2\n          location\n        }\n      }\n    }\n  }\n"],b||(b=a.slice(0)),Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(b)}})));return h=function(){return c},c}var Y=(0,d.Ps)(h()),i=a(94184),Z=a.n(i),$=a(32533);function _(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function aa(d){for(var a=1;a<arguments.length;a++){var c=null!=arguments[a]?arguments[a]:{},b=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(b=b.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),b.forEach(function(a){_(d,a,c[a])})}return d}function ab(b){var e=b.value,f=b.onChange,g=b.passProps.setPlaceId;b.isModal;var a=(0,q.useContext)(y.Z),d=a.options,c=a.filter,h=a.setFilter,i=a.isLoadingOptions,j=a.loadingGeolocation,k=a.clear,l=a.sessionId,m=a.placeId,n=(0,$.$G)("website",{keyPrefix:"order.options.updateBasicOptions"}).t,o=(0,q.useMemo)(function(){if(!e)return null;var b=Array.isArray(d)&&d.length?d[0]:null,a=d.find(function(a){return a.value===e});return null!=a?a:b},[d,e]),r=(0,q.useCallback)(function(b,a){"select-option"===a.action?((0,A.sendEvent)(A.EVENTS.selected.addressOption,{placeId:b.value,filter:c,sessionId:l,previousPlaceId:m}),f(b.value)):("clear"===a.action||"deselect-option"===a.action)&&k(z.Nl.PLACE_ID)},[k,c,f,m,l,g]);return(0,p.jsx)(s.default,{styles:{menu:function(a){return aa({},a,{zIndex:1001})},input:function(a,b){return a.color,aa({},function(a,d){if(null==a)return{};var b,c,e=function(c,f){if(null==c)return{};var a,b,d={},e=Object.keys(c);for(b=0;b<e.length;b++)a=e[b],f.indexOf(a)>=0||(d[a]=c[a]);return d}(a,d);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(c=0;c<f.length;c++)b=f[c],!(d.indexOf(b)>=0)&&Object.prototype.propertyIsEnumerable.call(a,b)&&(e[b]=a[b])}return e}(a,["color"]))}},classNamePrefix:"orion-select",placeholder:n("address.placeholder"),options:d,isClearable:!0,inputValue:null!=c?c:"",onInputChange:h,isLoading:i||j,noOptionsMessage:function(a){return a.inputValue?"No hemos podido encontrar tu direcci\xf3n. Puedes usar una ubicaci\xf3n de referencia y luego corregir la posici\xf3n en el mapa":"Escribe tu direcci\xf3n con calle y n\xfamero para que aparezcan los resultados"},value:o,onChange:r,filterOption:null},"loaded")}var j=a(5152),k=a.n(j),l=k()(function(){return Promise.all([a.e(9269),a.e(127),a.e(7194)]).then(a.bind(a,68764))},{loadableGenerated:{webpack:function(){return[68764]}},ssr:!1}),ac=l,ad=a(55672),m=a(29344),ae=a.n(m);function af(a){var b=a.value,d=a.onChange,c=(0,$.$G)("website",{keyPrefix:"order.options.updateBasicOptions"}).t;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ad.Z,{className:"os-input-text",placeholder:c("addressLine2.placeholder"),value:null!=b?b:"",onChange:d}),(0,p.jsx)("div",{className:ae().example_label,children:(0,p.jsx)("span",{children:c("addressLine2.example")})})]})}var ag=a(34053),n=a(65035),ah=a.n(n),ai=function(a){var c=a.condition,d=a.wrapper,b=a.children;return c?d(b):b};function aj(a){var b=a.disabled,c=a.onClick,d=a.message;return(0,p.jsx)(ai,{condition:b,wrapper:function(a){return(0,p.jsx)(ag.default,{className:ah().tooltip,content:"Completa todos los campos para continuar",children:a})},children:(0,p.jsx)("div",{className:ah().formSubmitButton,children:(0,p.jsx)(t.Z,{primary:!0,disabled:b,fullWidth:!0,onClick:c,children:d})})})}function ak(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function al(d){for(var a=1;a<arguments.length;a++){var c=null!=arguments[a]?arguments[a]:{},b=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(b=b.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),b.forEach(function(a){ak(d,a,c[a])})}return d}var e,am=["CL","PE","CO"];(e=c||(c={})).TOP="TOP",e.BOTTOM="BOTTOM";var an=function(f){var n,o,u,w,x,_,as,aa,at,au,av,j,ad,aw,ae,aV,aW,ax,ag,ay,az,aA,k,ai,aB,an,aX,aY,g=f.type,aC=f.isModal,ao=f.websiteId,bf=f.closeModal,aZ=f.onSelectDeliveryType,a$=f.showStoreName,bg=function(a){var b=a.coords.latitude,c=a.coords.longitude;aE({lat:b,lng:c}),bl(!1)},bh=function(a){bl(!1),1==a.code?((0,A.sendEvent)(A.EVENTS.error.locationAccessDenied,{sessionId:bm}),bn(new Error(h("geolocation.errors.accessDenied")))):2==a.code&&((0,A.sendEvent)(A.EVENTS.error.locationUnavailable,{sessionId:bm}),bn(new Error(h("geolocation.errors.unavailable"))))},a_=function(){if((0,A.sendEvent)(A.EVENTS.clicked.useLocation,{sessionId:bm}),bl(!0),navigator.geolocation){var a={timeout:6e4,enableHighAccuracy:!0,maximumAge:0};navigator.geolocation.getCurrentPosition(bg,bh,a)}else bl(!1),bn(new Error("Lo sentimos, tu navegador no soporta geolocalizaci\xf3n"))},a=(0,q.useContext)(y.Z),b=a.placeId,a0=a.setPlaceId,l=a.selectedCity,bi=a.setSelectedCity,aD=a.location,aE=a.setLocation,bj=a.clear,a1=a.addressLine2,bk=a.setAddressLine2,a2=a.loadingGeolocation,bl=a.setLoadingGeolocation,bm=a.sessionId,h=(0,$.$G)("website",{keyPrefix:"order.options.updateBasicOptions"}).t,a3=(0,C.Z)(),bn=(0,D.Z)(),aF=(0,q.useState)(!0),a4=aF[0],bo=aF[1],aG=Q(),m=aG.data,a5=aG.loading,d=null==m?void 0:null===(n=m.preferences)|| void 0===n?void 0:n.deliveryType,bp=(at=(as={}).onSuccess,au=as.onError,av=(0,F.Z)(),aw=(j=(0,S.D)(V),ad=1,function(a){if(Array.isArray(a))return a}(j)||function(b,e){var f,g,a=null==b?null:"undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(null!=a){var c=[],d=!0,h=!1;try{for(a=a.call(b);!(d=(f=a.next()).done)&&(c.push(f.value),!e||c.length!==e);d=!0);}catch(i){h=!0,g=i}finally{try{d||null==a.return||a.return()}finally{if(h)throw g}}return c}}(j,ad)||function(a,c){if(a){if("string"==typeof a)return T(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(b);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return T(a,c)}}(j,ad)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],ae=Q().data,(0,q.useCallback)((aW=(aV=R().mark(function a(b){var c;return R().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=4,aw({variables:{deliveryType:b,websiteId:av},optimisticResponse:{__typename:"Mutation",setUserPreferences:{__typename:"Preference",_id:null==ae?void 0:null===(c=ae.preferences)|| void 0===c?void 0:c._id,deliveryType:b}}});case 4:null==at||at(),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),null==au||au(a.t0);case 10:case"end":return a.stop()}},a,null,[[0,7]])}),function(){var a=this,b=arguments;return new Promise(function(d,e){var f=aV.apply(a,b);function c(a){U(f,d,e,c,g,"next",a)}function g(a){U(f,d,e,c,g,"throw",a)}c(void 0)})}),function(a){return aW.apply(this,arguments)}),[null==ae?void 0:null===(aa=ae.preferences)|| void 0===aa?void 0:aa._id,au,at,aw,av])),i=null==m?void 0:null===(o=m.preferences)|| void 0===o?void 0:o.storeId,bq=(ay=(ax={}).onSuccess,az=ax.onError,aA=(0,F.Z)(),aB=(k=(0,S.D)(Y),ai=1,function(a){if(Array.isArray(a))return a}(k)||function(b,e){var f,g,a=null==b?null:"undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(null!=a){var c=[],d=!0,h=!1;try{for(a=a.call(b);!(d=(f=a.next()).done)&&(c.push(f.value),!e||c.length!==e);d=!0);}catch(i){h=!0,g=i}finally{try{d||null==a.return||a.return()}finally{if(h)throw g}}return c}}(k,ai)||function(a,c){if(a){if("string"==typeof a)return W(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(b);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return W(a,c)}}(k,ai)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],an=Q().data,(0,q.useCallback)((aY=(aX=R().mark(function a(b){return R().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,aB({variables:{storeId:b,websiteId:aA},refetchQueries:["getMyOrderPreferences"]});case 3:null==ay||ay(),a.next=9;break;case 6:a.prev=6,a.t0=a.catch(0),null==az||az(a.t0);case 9:case"end":return a.stop()}},a,null,[[0,6]])}),function(){var a=this,b=arguments;return new Promise(function(d,e){var f=aX.apply(a,b);function c(a){X(f,d,e,c,g,"next",a)}function g(a){X(f,d,e,c,g,"throw",a)}c(void 0)})}),function(a){return aY.apply(this,arguments)}),[null==an?void 0:null===(ag=an.preferences)|| void 0===ag?void 0:ag._id,az,ay,aB,aA])),a6=(0,O.aM)({query:P.qj,variables:{websiteId:ao}}),a7=a6.data,aH=a7.stores,a8=(0,O.aM)({query:P.NV,variables:{websiteId:ao,storeId:i},omit:(0,B.Z)()||!ao,fetchPolicy:"cache-first",partial:!0}),aI=a8.data,a9=null!==(w=null==aH?void 0:aH.items)&& void 0!==w?w:[],aJ=a9.find(function(a){return a.value===i}),aK=null!==(x=null==aI?void 0:aI.preferences)&& void 0!==x?x:{},ba=am.includes(a3.toUpperCase()),aL=ba?c.BOTTOM:c.TOP,bb=(0,q.useRef)(null),aM=(0,q.useState)(0),ap=aM[0],br=aM[1],bs=function(){(null==bb?void 0:bb.current)&&br(bb.current.offsetWidth)};(0,q.useEffect)(function(){return bs(),window.addEventListener("resize",bs),function(){window.removeEventListener("resize",bs)}},[]);var aN=(0,G.Z)({placeId:b,storeId:i}),e=g;(g===z.tv.FormAndMap&&ap<650||g===z.tv.Form)&&(aL===c.TOP&&(e=z.tv.FormWithTopMap),aL===c.BOTTOM&&(e=z.tv.FormWithBottomMap));var aq=(0,E.Z)(),aO=e!==z.tv.DeliveryTypes,ar=d===z.TB.DELIVERY&&b||d!==z.TB.DELIVERY&&i,bc=ar&&e===z.tv.FormAndMap,aP=ar&&e===z.tv.FormWithTopMap,aQ=ar&&e===z.tv.FormWithBottomMap,aR=d===z.TB.DELIVERY?aD:null==aJ?void 0:null===(u=aJ.address)|| void 0===u?void 0:u.location,aS=d===z.TB.DELIVERY,bd=d===z.TB.DELIVERY?!b:!i,aT=(0,q.useMemo)(function(){return(aP||aQ)&&aR&&(0,p.jsx)(ac,{location:aR,isDraggingMarkerEnabled:aS,setLocation:function(a){bo(!0),aE(a)},containerClass:Z()(ah().embeddedMapContainer,ak({},ah().embeddedMapContainerThin,ap<650&&g!==z.tv.FormAndMap))})},[aS,aR,aE,aP,aQ,g,ap]),be=(0,q.useMemo)(function(){return bc&&aR&&(0,p.jsx)("div",{className:ah().mapSection,children:(0,p.jsx)(ac,{location:aR,isDraggingMarkerEnabled:aS,setLocation:function(a){bo(!0),aE(a)}})})},[aS,aR,aE,bc]),aU=function(){var a=aK.time;if(aJ&&(d!==z.TB.SERVE||aJ.acceptServeSchedulingOrders)&&(d!==z.TB.SERVE||"now"!==a))return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(N.Z,{selectorProps:{menuPosition:"fixed",styles:{menuPortal:function(a){return al({},a,{zIndex:1001})}}},onChange:function(){return bo(!0)},preferences:aK,showDirections:!!b&&"no-deliver"!==b}),aQ&&d!==z.TB.DELIVERY&&aT]})};return e===z.tv.DeliveryTypes?(0,p.jsx)("div",{style:{width:340},children:(0,p.jsx)(v.Z,{value:null,onChange:aZ,light:!0,passProps:{light:!0}})}):(0,p.jsxs)("div",{ref:bb,className:Z()(ah().formContainer,ah().container,(ak(_={},ah().modalFormContainer,e===z.tv.FormAndMap),ak(_,ah().backgroundColor,aC),_)),children:[be,(0,p.jsxs)("div",{className:Z()(ah().formSection,ak({},ah().formSectionThin,ap<650&&g!==z.tv.FormAndMap)),children:[(0,p.jsxs)("div",{children:[aO&&(0,p.jsx)("h2",{className:ah().formTitle,children:h("title")}),(0,p.jsx)(v.Z,{value:d,onChange:function(a){bo(!0),bp(a),a!==z.TB.DELIVERY&&!i&&(null==a9?void 0:a9.length)&&bq(a9[0].value)}}),d===z.TB.DELIVERY&&(0,p.jsx)(p.Fragment,{children:aO&&(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{className:ah().geolocationButton,children:(0,p.jsxs)(t.Z,{primary:!0,onClick:a_,loading:a2,fullWidth:!0,children:[(0,p.jsx)(r.vcr,{size:20}),h("sharePosition")]})}),aP&&aT,aq&&!b&&(0,p.jsx)("div",{className:ah().inputContainer,children:(0,p.jsx)(H.Z,{city:l?{label:l,value:l}:null,changeSelectedCity:function(a){if(!a)return bj(z.Nl.SELECTED_CITY);bj(z.Nl.PLACE_ID),bi(a.value)}})}),(!aq||l||b)&&(0,p.jsxs)("div",{className:ah().inputContainer,children:[(0,p.jsx)(ab,{value:b,onChange:function(a){bo(!0),a0(a)},passProps:{setPlaceId:a0},isModal:aC}),!a5&&(aN||b&&!aD)?(0,p.jsx)(I.Z,{message:aN||"No llegamos a esa direcci\xf3n"}):b?(0,p.jsx)(J.Z,{preferences:aK}):(0,p.jsx)("div",{className:ah().example_label,children:(0,p.jsx)("span",{children:h("address.example")})})]}),(!aq||b)&&(0,p.jsx)("div",{className:ah().inputContainer,children:(0,p.jsx)(af,{value:a1,onChange:function(a){bo(!0),bk(a)}})}),b&&aU(),aQ&&aT]})}),d!==z.TB.DELIVERY&&function(){if(!d)return(0,p.jsx)(L.Z,{preferences:aK});if(aK&&!a5){var a=null==a9?void 0:a9.filter(function(a){var b;return null!=a&&null!==(b=a.address)&& void 0!==b&&!!b.placeId&&(d===z.TB.GO&&!!a.acceptGo||d===z.TB.SERVE&&!!a.acceptServe)}),b=null==a?void 0:a.length;b||bq(null);var c=null==a?void 0:a.map(function(a){return a.value}).includes(i);(b&&!i||b&&i&&!c)&&bq(a[0].value);var e=a.find(function(a){return a.value===i});return(0,p.jsxs)("div",{children:[aP&&d!==z.TB.DELIVERY&&aT,(0,p.jsx)("div",{className:"label",style:{marginTop:0},children:h("labelChooseStore")}),(0,p.jsx)(s.default,{value:e,onChange:function(a){bo(!0),bq(a.value)},classNamePrefix:"orion-select",placeholder:h("labelSelectStore"),options:a,filterOption:null,menuPosition:aC?"fixed":void 0,styles:al({control:function(a){return al({},a,{padding:"4px 0"})}},aC?{menuPortal:function(a){return al({},a,{zIndex:1001})}}:{menu:function(a){return al({},a,{zIndex:1001})}})})]},"storeSelector".concat(d))}}(),d!==z.TB.DELIVERY&&aU(),d!==z.TB.DELIVERY&&function(){var a=aK.time;if(aJ&&d===z.TB.SERVE&&"now"===a)return(0,p.jsx)(M.Z,{preferences:aK})}(),(b||i)&&(0,p.jsx)(K.Z,{preferences:aK,website:{showStoreName:a$},isOnMenu:!0})]}),a4&&(0,p.jsx)(aj,{disabled:bd,message:d===z.TB.DELIVERY?h("useAddress"):h("useStore"),onClick:function(){(0,A.sendEvent)(A.EVENTS.clicked.addressSubmitButton),bo(!1),bf(),bn("Direcci\xf3n guardada")}})]})]})};function ao(b){var a=b.closeModal,c=(0,F.Z)();return(0,p.jsx)("div",{children:(0,p.jsxs)(x.Z,{close:a,customClass:ah().modal,avoidElementsClass:"submodal",children:[(0,p.jsx)("div",{className:ah().closeIconSection,children:(0,p.jsx)("div",{className:ah().closeIconContainer,children:(0,p.jsx)("div",{className:ah().closeIcon,onClick:a,children:(0,p.jsx)(r.FU5,{size:30})})})}),(0,p.jsx)(u.Z,{fallback:(0,p.jsx)("div",{className:ah().modalLoading,children:(0,p.jsx)(w.Z,{})}),children:(0,p.jsx)(an,{websiteId:c,closeModal:a,type:z.tv.FormAndMap,isModal:!0})})]})})}},29344:function(a){a.exports={example_label:"mFyGw6-BPyWPOvwl3ehht"}},65035:function(a){a.exports={modal:"WcSjqTkX5cCwbq5Uudevg",formContainer:"_1vKpBxKdBzZvkC2GJkVtAw textColor",backgroundColor:"_3QNOHXIrNir1zfKlCAsv_g backgroundColor",modalFormContainer:"czWgFcPpP17gG3Dp2ypIL",mapSection:"_3b2jXLHXxSWBXN3tTwc4Jm",formSection:"tUco8lvuH0Pc7EsANa-tC",formSectionThin:"_18UyoeQZZkRANTA6_BS70R",formTitle:"_1pbTpWeXc4yEy3WsOwig-Y",formSubmitButton:"_14taenL1Y7jPUi594KOUIH",dragPinButtonContainer:"_2VZC0ex5xq4kRAE-BueK3n",separator:"HYqS86ExGwBY_Uj0Pen3C",separatorLine:"_2p679FoWKAkma_mdMvI6kF",separatorText:"_11w0c0r8dltKgh_MXqybfK",embeddedMapContainer:"_1TFfHXhHTL9RH2dSoAkTtS",embeddedMapContainerThin:"wnkIpzyeH6N-o2gxx6AEU",example_label:"_18zVJxAm1HoZpCM31AIsew",closeIconSection:"_1JGEdTziUJDetRNmMauDAs",closeIconContainer:"_3rfF75iddiNpqWnnlUz475",closeIcon:"_2l0lXgqHAjBEa9cBRO8kHj",modalLoading:"_2-EfXtNwvGQxvzhKupBaBQ",inputContainer:"_3z4OSDnifHhy8amjJZb6ze",container:"_1BlyEffYLRDjpnrazYOBO2"}}}])
//# sourceMappingURL=3154.15a8fe3e7f3abd90.js.map